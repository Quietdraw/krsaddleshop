/**
 * cms2 v2020.1.0 copyright (c) 2000-2019, NetSuite Inc.
 *
 * @license See LICENSES.txt (same path as this js file)
 */
!function(){function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(a)return a(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){return i(t[r][1][e]||e)},u,u.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}return e}()({1:[function(e,t,n){"use strict";function o(e){this.allowedOrigin=e,this.listenerReady=!1,this.setupListener()}var i=function(){function e(e){if(e)return t(e)}function t(t){for(var n in e.prototype)t[n]=e.prototype[n];return t}return e.prototype.on=e.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},e.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o,i=0;i<n.length;i++)if((o=n[i])===t||o.fn===t){n.splice(i,1);break}return this},e.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var o=0,i=n.length;o<i;++o)n[o].apply(this,t)}return this},e.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},e.prototype.hasListeners=function(e){return!!this.listeners(e).length},new e}();Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,o=function(){},i=function(){return n.apply(this instanceof o&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return o.prototype=this.prototype,i.prototype=new o,i});var a=n.Postframe;o.prototype.noConflict=function(){return n.Postframe=a,o},o.prototype.debug=function(){if(void 0!==this.debugFn())return this._debugFn.apply(this,arguments)},o.prototype.debugFn=function(e){return e&&(this._debugFn=e),this._debugFn},o.prototype.send=function(){this.debugFrame();var e=Array.prototype.slice.call(arguments),t=e.shift(),n="string"==typeof e[0]&&e.shift(),o=!(e[0]instanceof Function)&&e.shift(),i=e[0]instanceof Function&&e.shift(),a=(+new Date).toString()+Math.random();i&&this.once(n+":response:"+a,i),t.postMessage({id:a,message:n,result:null,params:o,done:!1},this.allowedOrigin)},o.prototype.debugFrame=function(){window.self,window.top},o.prototype.on=function(e,t){return this.debug("postframe.on("+e+")"),i.on.apply(this,arguments)},o.prototype.once=function(e,t){return this.debug("postframe.once("+e+")"),i.once.apply(this,arguments)},o.prototype.off=function(e,t){return this.debug("postframe.off("+e+")"),i.off.apply(this,arguments)},o.prototype.bindEventToElement=function(e,t,n){return e.addEventListener?e.addEventListener(t,n):e.attachEvent?e.attachEvent("on"+t,n):void 0},o.prototype.emit=function(e,t){this.debugFrame();var n=Array.prototype.slice.call(arguments),e=n.shift(),t=n.shift();if(this.debug("postframe.emit("+e+")",t),t&&void 0==t.done)return n.unshift(e,t),i.emit.apply(this,n);if(t&&!t.done){var o=function(){var n=Array.prototype.slice.call(arguments),o=n.shift();this.debug("postframe.doneFn("+e+")",t),this.sourceWindow.postMessage({id:!!t&&t.id,message:e,result:o,params:t.params?t.params:n,done:!0},this.allowedOrigin)}.bind(this);n.unshift(e,o),t.params&&n.splice(2,0,t.params)}else n.unshift(e,t),t&&t.params&&n.splice(2,0,t.params);i.emit.apply(this,n)},o.prototype.setupListener=function(){this.listenerReady||(this.bindEventToElement(window,"message",function(e){if(this.allowedOrigin!=e.origin)return void this.debug("Orgin disallowed!",e.origin,this.allowedOrigin);this.debugFrame(),this.sourceWindow=e.source;var t=e.data,n=t.message,o=[];t.done?(this.debug("DONE "+n),t.id&&(n+=":response:"+t.id),o=[n,t.result]):(this.debug("NOT done "+n),o=[t.message,t]),t.params&&o.push(t.params),this.emit.apply(this,o)}.bind(this)),this.listenerReady=!0)},t.exports=o},{}],2:[function(e,t,n){"use strict";var o=o||{};o.VERSION="2.1.0",window.CMS=o,function(t,n,i){var a=(e("./polyfill"),e("./common")),r=e("./utility"),s=e("./satellite-core"),c=e("../../base/libs/postframe");window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),r.initLibraries(t,n),s.initLibraries(t,n,i,o);var l,u,d,p=new c(window.location.origin),f=!1,_="https://system.netsuite.com",m=null,g=null,h=null,v=function(){t.ajaxPrefilter(function(e){var t;"/api/cms/"===e.url.substring(0,"/api/cms/".length)&&(t=r.readCookie(a.cookie_keys.VERSION_ID),t&&""!==t&&(e.url=r.formatQuerystringParameter(e.url,"version_id",t),e.url=r.formatQuerystringParameter(e.url,"site_id",g)),e.url=r.formatQuerystringParameter(e.url,"c",m))})},E={loaded:!1,load:function(e){var n=this;n.loaded||u({type:"GET",url:h,dataType:"text",success:function(e){n.loaded||(n.loaded=!0,t.globalEval(e))},error:e?function(){}:n.hardErrorCallback})},hardErrorCallback:function(){console.log("No cms templates file was found.")}},y=function(){var e,t=5e3,n=!1,o=!1,i=!1,c=function(){E=null,A()};v(),s.admin_exists||u({type:"GET",url:"/api/cms/versions?site_id="+g,success:function(e){var t;e.live_version?(t=new l(e.live_version),r.createCookie(a.cookie_keys.VERSION_ID,t.get("key")),o=!0):i=!0}}),E.load(!0),e=setInterval(function(){var a=!1;f&&!a&&(a=!0,s.getSetupFromAdapter().done(function(){n=!0})),E.loaded&&n&&(s.admin_exists||o)?(clearInterval(e),c()):n&&i?(clearInterval(e),c()):t<=0&&(console.log("Error: Unable to load CMS"),clearInterval(e)),t-=20},20)},T=function(e){e&&e.esc_to_login_disabled?t(document).off(".esc_to_login"):t(document).on("keyup.esc_to_login",function(e){27===e.which&&(s.feature_enabled?r.forwardToUrl("/cms/2/admin/cms.jsp?from="+encodeURIComponent(location.pathname+location.hash)):alert("The Site Management Tools feature has not been enabled."))})},A=function(){var e={setup:s.setup,base_url:_,comp_id:m},i=function(){s.getPage()};o.on(a.api_events.ADAPTER_PAGE_CHANGED,s.handlePageChanged,s),o.on(a.api_events.CMS_RENDERED,s.cmsRendered,s),s.admin_exists?(s.bindCMSListeners(),p.send(window.parent,"sat-ready",e,function(){var e;MutationObserver?(e=new MutationObserver(function(){s.sendPositionsToAdmin()}),e.observe(t("html")[0],{attributes:!0,childList:!0,characterData:!0,subtree:!0}),setInterval(function(){s.sendPositionsToAdmin()},1e3)):setInterval(function(){s.sendPositionsToAdmin()},500),t(window).on("resize.cms",n.debounce(function(){s.sendPositionsToAdmin()},300)),i()})):(T(s.setup),i())},b=t.Deferred();s.setPostframe(p),n.extend(o,i.Events),l=i.Model.extend({urlRoot:"/api/cms/versions",defaults:{id:null,name:null,desc:null,order:null,start_date:null,end_date:null,hosting_root:null,approved:null,release_date:null,site_id:null}}),o.api={enableDebug:function(){s.enableDebug()},disableDebug:function(){s.disableDebug()},getNavigation:function(e){var t=e.context||e;return n.defaults(e,{success:function(){},error:function(){}}),s.apiGetNavigation(e.navigation,function(n){n.success?e.success.call(t,n):e.error.call(t,n)}),this},getContent:function(e){var t,o=e.context||e;return n.defaults(e,{success:function(){},error:function(){}}),!!(t=e.content_id)&&(s.apiGetContent(t,function(t){t.success?e.success.call(o,t):e.error.call(o,t)}),this)},getArea:function(e){var t=e.context||e;return n.defaults(e,{success:function(){},error:function(){}}),s.apiGetArea(e.area,function(n){n.success?e.success.call(t,n):e.error.call(t,n)}),this},getLandingPages:function(e){return n.defaults(e,{success:function(){},error:function(){}}),s.apiGetLandingPages(function(t){t.success?e.success(t.pages):e.error(t.pages)}),this},getCategories:function(e){return n.defaults(e,{success:function(){},error:function(){}}),b.then(function(){s.commerce_categories_enabled?s.apiGetCategories(e.view,function(t){t.success?e.success(t.categories):e.error(t)}):e.error({error:"The feature 'Commerce Categories' required to access this page is not enabled in this account. The feature 'Commerce Categories' required to access this page is not enabled in this account.",errors:{feature_enabled:!1}})}),b},getMerchzone:function(e){var t=e.context||e;return e.merch_rule_id?(n.defaults(e,{success:function(){},error:function(){}}),s.apiGetMerchzone(e.merch_rule_id,function(n){n.success?e.success.call(t,n.d):e.error.call(t,n.d)}),this):void console.warn('ERROR: a "merch_rule_id" must be passed to getMerchzone')},setDisableEscapeToLogin:function(e){T(e)}},u=function(e){void 0===e.url&&console.log("Cannot make an ajax request without a url."),n.defaults(e,{type:"POST",data:{},contentType:"application/json; charset=utf-8",dataType:"json",success:function(){},error:function(){},complete:function(){}}),t.ajax({type:e.type,url:e.url,data:e.data,contentType:e.contentType,dataType:e.dataType,success:e.success,error:e.error,complete:e.complete})},s.setAjaxRequest(u),window.parent!==window&&p.send(window.parent,"cms-hello",function(){s.admin_exists=!0}),d=".ns_is-edit .cms-content,.ns_is-edit [data-cms-area]{display:block !important;min-height:50px !important}.cms-content-text h1,.cms-content-text h2,.cms-content-text h3,.cms-content-text h4,.cms-content-text h5,.cms-content-text h6,.cms-content-text ol,.cms-content-text ul,.cms-content-text blockquote{display:block !important}",t("<style>",{id:"cms-css",type:"text/css"}).text(d).appendTo("head"),o.once(a.api_events.ADAPTER_READY,function(){f=!0}),n.delay(function(){t.ajax({type:"GET",url:"/api/cms/session/domain",contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){var n;s.feature_enabled=e.feature_enabled,s.commerce_categories_enabled=e.commerce_categories_enabled,e.system_domain&&(n=t.trim(e.system_domain)),n&&e.comp_id?(_=n.replace(/\/+$/,""),m=e.comp_id,h=void 0!==e.live_template_path&&t.trim(e.live_template_path).length>0?e.live_template_path:"/cms/2/assets/defaulttemplates/cms-templates-014ead962bfc.js",s.setTemplatesPath(h),void 0!==e.live_template_content&&t.trim(e.live_template_content).length>0&&(E.loaded=!0,t.globalEval(e.live_template_content)),g=e.site_id,y()):s.failed_to_get_domain=!0,b.resolve()},error:function(){s.failed_to_get_domain=!0,b.reject()}})},0)}(jQuery,_,Backbone)},{"../../base/libs/postframe":1,"./common":3,"./polyfill":4,"./satellite-core":5,"./utility":6}],3:[function(e,t,n){"use strict";var o=function(){var e={api_events:{ADAPTER_READY:"adapter:ready",ADAPTER_PAGE_CHANGED:"adapter:page:changed",ADAPTER_GET_PAGE_CONTEXT:"adapter:get:context",ADAPTER_GOT_PAGE_CONTEXT:"adapter:got:context",ADAPTER_GET_SETUP:"adapter:get:setup",ADAPTER_GOT_SETUP:"adapter:got:setup",ADAPTER_GET_CART_ITEMS:"adapter:get:cart:items",ADAPTER_GOT_CART_ITEMS:"adapter:got:cart:items",ADAPTER_GET_CURRENT_ITEM:"adapter:get:current:item",ADAPTER_GOT_CURRENT_ITEM:"adapter:got:current:item",ADAPTER_GET_ITEMS:"adapter:get:items",ADAPTER_GOT_ITEMS:"adapter:got:items",CATEGORY_ADD:"adapter:category:add",CATEGORY_RELOAD:"adapter:category:reload",CATEGORY_HIERARCHY_CHANGE:"adapter:category:hierarchy:change",CATEGORY_ITEM_UPDATE:"adapter:category:item:update",CATEGORY_NAVIGATE:"adapter:category:navigate",CATEGORY_REMOVE:"adapter:category:remove",CATEGORY_UPDATE:"adapter:category:update",LANDING_PAGES_ADD:"adapter:landing:pages:add",LANDING_PAGES_NAVIGATE:"adapter:landing:page:navigate",LANDING_PAGES_RELOAD:"adapter:landing:pages:reload",LANDING_PAGES_REMOVE:"adapter:landing:pages:remove",LANDING_PAGE_UPDATE:"adapter:landing:page:update",CMS_RENDERED:"cms:rendered",PREVIEW_SEGMENT_APPLY:"preview:segment:apply"},cookie_keys:{VERSION_ID:"version_id",CMS_CDN_CACHE:"cmscb"}};return Object.freeze(e),e};t.exports=new o},{}],4:[function(e,t,n){"use strict";var o=function(){return function(){Object.freeze||(Object.freeze=function(e){return e})}(),null};t.exports=new o},{}],5:[function(e,t,n){"use strict";var o=e("./common"),i=e("./utility"),a=function(){var e,t,n,a,r,s,c,l,u="undefined"!=typeof nsglobal,d={setup:null,admin_exists:!1,failed_to_get_domain:!1,_areas_cache:null,_area_and_content_positions_cache:null,initLibraries:function(e,t,o,i){n=e,a=t,r=o,s=i,l=r.Model.extend({urlRoot:"/api/cms/pages/contents",defaults:{title:null,path:null,page_type:null,template:null,visible:null,nav_title:null,areas:null}})},setPostframe:function(t){e=t},setTemplatesPath:function(e){c=e},setAjaxRequest:function(e){t=e},enableDebug:function(){d.admin_exists?e.send(window.parent,"enableDebug"):console.log("CMS admin is not being used, cannot enable debug.")},disableDebug:function(){d.admin_exists?e.send(window.parent,"disableDebug"):console.log("CMS admin is not being used, cannot disable debug.")},apiGetNavigation:function(){},apiGetContent:function(){},apiGetArea:function(){},apiGetLandingPages:function(){var n,o=a.last(arguments);d.admin_exists?e.send(window.parent,"sat-get-landing-page",function(e){n={success:!0,pages:e},o(n)}):t({type:"GET",url:"/api/cms/pages/",success:function(e){n={success:!0,pages:e.pages},o(n)}})},apiGetCategories:function(n){var o,i=a.last(arguments),r="/api/cms/categories/";n&&(r+="list"===n.toLowerCase()?"?view=list":""),d.admin_exists?(e.once("sat-categories-response",function(e,t){o=void 0===t.errors?{success:!0,categories:t}:t,i(o)}),e.send(window.parent,"sat-get-categories",n)):t({type:"GET",url:r,success:function(e){o={success:!0,categories:e.categories},i(o)},error:function(e){i(e.responseJSON)}})},apiLandingPageRelay:function(e){var t,n=a.last(arguments);switch(e.method){case"add":t=o.api_events.LANDING_PAGES_ADD;break;case"update":t=o.api_events.LANDING_PAGE_UPDATE;break;case"remove":t=o.api_events.LANDING_PAGES_REMOVE;break;case"navigate":t=o.api_events.LANDING_PAGES_NAVIGATE;break;case"route-all":t=o.api_events.LANDING_PAGES_RELOAD;break;default:return void n({error:"Could not find event for method given."})}d.admin_exists&&s.trigger(t,e,function(e){n(e)})},apiGetMerchzone:function(e){var n=a.last(arguments);t({type:"GET",url:"/api/cms/merchzones/"+e,success:function(e){n({success:!0,d:e})}})},getSetupFromAdapter:function(){var e=this,t=n.Deferred();return s.once(o.api_events.ADAPTER_GOT_SETUP,function(n){e.setup=JSON.parse(JSON.stringify(n)),e.setup&&e.setup.features&&e.setup.features.indexOf("customerSegmentPreview")>=0&&s.trigger(o.api_events.PREVIEW_SEGMENT_APPLY,{pcv_groups:[],pcv_all_items:!0}),t.resolve()}),s.trigger(o.api_events.ADAPTER_GET_SETUP),t.promise()},getPage:function(){var e=this;d.admin_exists||(s.once(o.api_events.ADAPTER_GOT_PAGE_CONTEXT,function(t){var o;t=a.pick(t,"path","page_type","site_id"),t&&(t.path=i.prependUrlSlash(t.path)),o=new l(t),o.fetch({data:n.param(a.omit(t,"site_id")),success:function(){null===o.get("areas")&&o.set("areas",[]),e.renderPageContent(o.toJSON())}})}),s.trigger(o.api_events.ADAPTER_GET_PAGE_CONTEXT))},handlePageChanged:function(){var t=this;t.getPage(),s.once(o.api_events.ADAPTER_GOT_PAGE_CONTEXT,function(t){t&&(t.path=i.prependUrlSlash(t.path)),e.send(window.parent,"sat-adapter-page-changed",t)}),s.trigger(o.api_events.ADAPTER_GET_PAGE_CONTEXT),t._areas_cache=null},cmsRendered:function(){d.admin_exists&&e.send(window.parent,"sat-cms-rendered")},bindCMSListeners:function(){e.on("sat-get-page-context",function(e){s.once(o.api_events.ADAPTER_GOT_PAGE_CONTEXT,function(t){t&&(t.path=i.prependUrlSlash(t.path)),e(t)}),s.trigger(o.api_events.ADAPTER_GET_PAGE_CONTEXT)}),e.on("sat-get-items",function(t,n){s.once(o.api_events.ADAPTER_GOT_ITEMS,function(t){e.send(window.parent,"sat-got-items",t)}),s.trigger(o.api_events.ADAPTER_GET_ITEMS,n)}),e.on("sat-render-page",function(e,t){d.renderPageContent(t)}),e.on("sat-find-area-and-content-positions",function(e){e(d.findAreaAndContentPositions())}),e.on("sat-get-content-clone",function(e,t){e(d.cloneContentElement(t))}),e.on("sat-cms-new-content",function(e,t){d.renderNewPageContent(t)}),e.on("sat-cms-rerender-content",function(e,t){t.id_sync_fix?(n(t.id_sync_fix).remove(),delete t.id_sync_fix,d.renderNewPageContent(t)):d.rerenderPageContent(t)}),e.on("sat-cms-remove-content-html",function(e,t){n(t).remove(),e()}),e.on("sat-cms-get-content-html",function(e,t){e(n(t).html())}),e.on("sat-make-content-invisible",function(e,t){var o,i,r=n(t),s=r.attr("style");s&&(o=s.replace(/\s/g,"").match(/opacity:\d\.?\d*/gi),i=!!o&&a.last(o).split(":")[1]),r.data("cmsSavedOpacity",i),r.css({opacity:0}),e()}),e.on("sat-make-content-visible",function(e,t){var o=n(t),i=o.data("cmsSavedOpacity");n(t).css({opacity:i||""}),e()}),e.on("sat-render-placeholder-height",function(e,t){d.addPlaceholderHeight(t),e()}),e.on("sat-add-html-class",function(e,t){n("html").addClass(t)}),e.on("sat-remove-html-class",function(e,t){n("html").removeClass(t)}),e.on("sat-landing-page-relay",function(e,t){d.apiLandingPageRelay(t,function(t){e(t)})}),e.on("sat-cms-move-content-html",function(e,t){var o,i,a=!1,r=n("#"+t.content_selector),s=d._areas_cache,c=s.filter('[data-cms-area="'+t.new_area+'"]'),l=t.position;0===l?(c.prepend(r),a=!0):(i=c.children(),i.length?l>i.length-1?r.is(i.last())||(c.append(r),a=!0):(o=i.eq(l),r.is(o.prev())||(r.insertBefore(o),a=!0)):console.log("Cannot move existing content for sort. There were no children in the new area and the requested position was not 0.")),e(a)}),e.on("sat-scroll-by",function(e,t){d.scrollBy(t.scroll_by),e()}),e.on("sat-scroll-to",function(e,t){d.scrollTo(t.scroll_to,t.duration,function(){e()})}),e.on("sat-category-reload",function(e,t){d.admin_exists&&s.trigger(o.api_events.CATEGORY_RELOAD,t,function(t){e(t)})}),e.on("sat-category-added",function(e,t){d.admin_exists&&s.trigger(o.api_events.CATEGORY_ADD,t,function(t){e(t)})}),e.on("sat-category-deleted",function(e,t){d.admin_exists&&s.trigger(o.api_events.CATEGORY_REMOVE,t,function(t){e(t)})}),e.on("sat-category-hierarchy-changed",function(e,t){d.admin_exists&&s.trigger(o.api_events.CATEGORY_HIERARCHY_CHANGE,t,function(t){e(t)})}),e.on("sat-category-item-updated",function(e,t){d.admin_exists&&s.trigger(o.api_events.CATEGORY_ITEM_UPDATE,t,function(t){e(t)})}),e.on("sat-navigate-category",function(e,t){d.admin_exists&&s.trigger(o.api_events.CATEGORY_NAVIGATE,t,function(t){e(t)})}),e.on("sat-category-updated",function(e,t){d.admin_exists&&s.trigger(o.api_events.CATEGORY_UPDATE,t,function(t){e(t)})})},sendPositionsToAdmin:function(){var t=this,n=t.findAreaAndContentPositions();a.isEqual(n,t._area_and_content_positions_cache)||(t._area_and_content_positions_cache=n,e.send(window.parent,"sat-positions-changed",n,function(){}))},findAreaAndContentPositions:function(){var e,t=this,o=[];return t._areas_cache?e=t._areas_cache:(e=n("[data-cms-area]").filter(":visible"),t._areas_cache=e),e.each(function(e,r){var s,c=n(r),l=c.data("cmsArea"),u=c.data("cmsAreaFilters"),d=i.getElementBounds(c),p=function(e,t){return a.each(t,function(n,o){var i=e[o],a=i-n;Math.abs(a)<1?t[o]=i:t[o]=Math.round(2*n)/2}),t};t._area_and_content_positions_cache&&(s=a.find(t._area_and_content_positions_cache,function(e){return e.name===l}))&&(d=p(s.bounds,d)),o.push({name:l,filters:u,bounds:d,content:[]}),n(".cms-content",c).filter(":visible").each(function(r,c){var l,u=n(c),d=u.attr("id"),f=i.getElementBounds(u);t._area_and_content_positions_cache&&(l=a.find(s.content,function(e){return e.html_id===d}))&&(f=p(l.bounds,f)),o[e].content.push({html_id:d,bounds:f})})}),o},cloneContentElement:function(e){return n(i.cloneElement(n(e))).prop("outerHTML")},generateContentHtmlClass:function(e,t){return(t?".":"")+"cms-content cms-content-"+e.type.toLowerCase()},generateContentHtmlID:function(e,t){return(t?"#":"")+"cms-content-"+e.id+"-"+e.current_context},renderContentByType:function(e,o){var i,r,c=this,l=e.type,u="";switch("boolean"!=typeof o&&(o=!1),l){case"TEXT":r=e.fields?n.trim(e.fields.clob_html):"",""!==r&&(u=r);break;case"IMAGE":e.fields&&e.fields.string_src&&(i=a.template(s.templates.image_default_tmpl,null,{variable:"data"}),u=i(e),u=c.modImagesForSEO(u));break;case"HTML":r=e.fields?n.trim(e.fields.clob_html):"",""!==r&&(u=r);break;case"MERCHZONE":e.fields.clob_merch_rule_url&&(o?t({type:"GET",url:decodeURIComponent(e.fields.clob_merch_rule_url),success:function(t){var n=c.renderMerchzone(e,t);u=n}}):s.api.getMerchzone({merch_rule_id:e.fields.number_merch_rule_id,success:function(n){n&&n.merch_zone&&!n.merch_zone.is_inactive&&n.merch_zone.query_string&&t({type:"GET",url:decodeURIComponent(n.merch_zone.query_string),success:function(t){var o=c.renderMerchzone(e,t,n.merch_zone);u=o}})}}))}return u},modImagesForSEO:function(e){return u&&(e=n("<div>").html(e).find("img").wrap("<noscript></noscript>").end().prop("innerHTML")),e},renderMerchzone:function(e,t,o){var i,r,c,l,u,d,p,f=this,_=f.generateContentHtmlID(e,!0),m=n.Deferred();return void 0===o?(i=e.fields.boolean_exclude_cart,r=e.fields.boolean_exclude_current,c=e.fields.number_merch_rule_count,l=e.fields.string_merch_rule_template):(i=o.cart_item,r=o.current_item,c=o.number_of_results,l=o.template),u=s.templates[l]||s.templates.merchzone_default_tmpl,t.title=e.name,t.description=e.desc,f.getCurrentAndCartItems(i,r).then(function(e){t.items=a.filter(t.items,function(t){return-1===e.indexOf(1*t.internalid)}),t.items=t.items.slice(0,c),f.normalizeItemImagesForMerchzone(t.items),u?(d=a.template(u,null,{variable:"data"}),p=d(t),p=f.modImagesForSEO(p)):(console.warn("No merchzone template found."),p='<div class=ns_merch_no_template_placeholder"></div>'),n(_).empty().append(p),m.resolve(p)}),m},getCurrentAndCartItems:function(e,t){var i=n.Deferred(),r=[],c=!1,l=!1,u=function(){t&&!c||e&&!l||i.resolve(r)};return e&&(s.once(o.api_events.ADAPTER_GOT_CART_ITEMS,function(e){a.each(e,function(e){r.push(e)}),l=!0,u()}),s.trigger(o.api_events.ADAPTER_GET_CART_ITEMS)),t&&(s.once(o.api_events.ADAPTER_GOT_CURRENT_ITEM,function(e){a.each(e,function(e){r.push(e)}),c=!0,u()}),s.trigger(o.api_events.ADAPTER_GET_CURRENT_ITEM)),window.setTimeout(function(){i.resolve(r)},200),i.promise()},normalizeItemImagesForMerchzone:function(e){var t=c.substring(0,c.lastIndexOf("/")+1)+"no_image_available.gif",n=function e(t){return"url"in t&&"altimagetext"in t?[t]:a.flatten(a.map(t,function(t){return a.isArray(t)?t:e(t)}))};a.each(e,function(e){var o;e.cms=e.cms||{},e.cms.image={url:t,alt_text:"no image available"},void 0!==e.itemimages_detail&&(o=n(e.itemimages_detail))&&o.length&&(e.cms.image.url=o[0].url,e.cms.image.alt_text=o[0].altimagetext||"")})},renderPageContent:function(e){var t=this;n.each(e.areas,function(e,o){var i='[data-cms-area="'+o.name+'"]',a="";n.each(o.contents,function(e,n){a+='<div class="'+t.generateContentHtmlClass(n)+'" id="'+t.generateContentHtmlID(n)+'">',a+=t.renderContentByType(n),a+="</div>"}),n(i).html(a)}),s.trigger(o.api_events.CMS_RENDERED)},rerenderPageContent:function(e){var t=this,i=t.generateContentHtmlID(e,!0),a=t.renderContentByType(e,!0);t.removePlaceholderHeight(i),(a||""===a)&&n(i).empty().append(a),s.trigger(o.api_events.CMS_RENDERED)},renderNewPageContent:function(e){var t=this,i=a.findWhere(e.context,{id:e.current_context}),r=i.sequence,c=n('[data-cms-area="'+i.area+'"]'),l=c.children(),u='<div class="'+t.generateContentHtmlClass(e)+'" id="'+t.generateContentHtmlID(e)+'">'+t.renderContentByType(e,!0)+"</div>";0===r||0===l.length?c.prepend(u):r>l.length-1?c.append(u):l.eq(r).before(u),s.trigger(o.api_events.CMS_RENDERED)},addPlaceholderHeight:function(e){var t=n(e);t.css({height:Math.round(t.width()/1.62)+"px","max-height":"300px"})},removePlaceholderHeight:function(e){n(e).css({height:"","max-height":""})},scrollBy:function(e){void 0===e&&(e={}),a.defaults(e,{y:0,x:0}),window.scrollBy(e.x,e.y)},scrollTo:function(e,t,o){void 0===e&&(e={}),void 0===t&&(t=0),a.defaults(e,{y:n(document).scrollTop(),x:n(document).scrollLeft()}),n("html, body").animate({scrollTop:e.y,scrollLeft:e.x},1e3*t,function(){"function"==typeof o&&o.call()})}};return d};t.exports=new a},{"./common":3,"./utility":6}],6:[function(e,t,n){"use strict";var o=function(){var e,t,n={initLibraries:function(n,o){e=n,t=o},readCookie:function(e){var t,n,o=encodeURIComponent(e)+"=",i=document.cookie.split(";");for(t=0;t<i.length;t++){for(n=i[t];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(o))return decodeURIComponent(n.substring(o.length,n.length))}return null},createCookie:function(e,t,n,o){var i,a="",r="";e&&(t||""===t)?(n&&(i=Date.now(),i.setTime(i.getTime()+24*n*60*60*1e3),a="; expires="+i.toGMTString()),o&&(r="domain="+o),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+"; path=/;"+r):console.log("Cannot create a cookie without a name or value.")},formatQuerystringParameter:function(e,n,o){var i=n+"="+o;return e&&t.contains(e,"?")?e.indexOf("?")!==e.length-1&&(i="&"+i):i="?"+i,e+=i},getElementBounds:function(t){t instanceof e&&(t=t.get(0));var n=window.pageXOffset,o=window.pageYOffset,i=t.getBoundingClientRect(),a=i.top+o,r=i.right+n,s=i.bottom+o,c=i.left+n;return{top:a,right:r,bottom:s,left:c,x_center:(c+r)/2,y_center:(a+s)/2,width:i.right-i.left,height:i.bottom-i.top}},getElementStyles:function(e){var n,o={};return window.getComputedStyle&&(n=window.getComputedStyle(e,null),t.each(n,function(e){o[e]=n.getPropertyValue(e)})),o},copyElementStyles:function(o,i){return function o(i,a){var r=n.getElementStyles(i),s=["user-modify","binding","float-edge","force-broken-image-icon","image-region","stack-sizing","window-dragging","window-shadow"],c="";for(t.each(r,function(e,n){t.contains(s,n.replace(/^-[^-]+-/,""))?r=t.omit(r,n):c+=n+":"+e+" !important; "}),e(a).attr("style",c),e(a).attr("data-cms-style-object",JSON.stringify(r)),i=i.firstChild,a=a.firstChild;i;)"string"==typeof i.tagName&&o(i,a),i=i.nextSibling,a=a.nextSibling}(o,i),i},cloneElement:function(t){t instanceof e&&(t=t.get(0));var o=e(t),i=o.clone();return n.copyElementStyles(t,i.get(0)),i},forwardToUrl:function(e){location.assign(e)},prependUrlSlash:function(e){var t=e;return e&&"/"!==e.substr(0,1)&&"http"!==e.substr(0,4)&&(t="/"+e),t}};return window.is_testing||Object.freeze(n),n};t.exports=new o},{}]},{},[2]);